<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation Transcript - StarCiti Sales Agent</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
            @bottom-right {
                content: "Page " counter(page) " of " counter(pages);
                font-size: 10px;
                color: #666;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 11pt;
            line-height: 1.6;
            color: #1a1a1a;
            background: white;
        }

        .header {
            text-align: center;
            padding: 20px 0 30px 0;
            border-bottom: 3px solid #2563eb;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28pt;
            color: #2563eb;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 13pt;
            color: #64748b;
            font-weight: 400;
        }

        .meta-info {
            background: #f8fafc;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #2563eb;
        }

        .meta-info .row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .meta-info .row:last-child {
            margin-bottom: 0;
        }

        .meta-info .label {
            font-weight: 600;
            color: #475569;
        }

        .meta-info .value {
            color: #1e293b;
        }

        .conversation {
            margin-top: 30px;
        }

        .message {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .message-role {
            font-weight: 700;
            font-size: 12pt;
            margin-right: 12px;
            padding: 4px 12px;
            border-radius: 4px;
            display: inline-block;
        }

        .message-role.user {
            background: #10b981;
            color: white;
        }

        .message-role.assistant {
            background: #2563eb;
            color: white;
        }

        .message-timestamp {
            font-size: 9pt;
            color: #94a3b8;
        }

        .message-content {
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 3px solid #e2e8f0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .message.user .message-content {
            border-left-color: #10b981;
        }

        .message.assistant .message-content {
            border-left-color: #2563eb;
        }

        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            font-size: 10pt;
            color: #64748b;
        }

        .footer a {
            color: #2563eb;
            text-decoration: none;
        }

        .summary-box {
            background: #eff6ff;
            border: 2px solid #2563eb;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }

        .summary-box h2 {
            color: #2563eb;
            font-size: 16pt;
            margin-bottom: 12px;
        }

        .summary-box p {
            color: #1e293b;
            line-height: 1.8;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>StarCiti Sales Agent</h1>
        <div class="subtitle">Conversation Transcript</div>
    </div>

    <!-- Meta Information -->
    <div class="meta-info">
        <div class="row">
            <span class="label">Conversation ID:</span>
            <span class="value">{{ conversation_id }}</span>
        </div>
        <div class="row">
            <span class="label">Started:</span>
            <span class="value">{{ started_at }}</span>
        </div>
        <div class="row">
            <span class="label">Completed:</span>
            <span class="value">{{ completed_at }}</span>
        </div>
        <div class="row">
            <span class="label">Total Messages:</span>
            <span class="value">{{ total_messages }}</span>
        </div>
        <div class="row">
            <span class="label">Contact Email:</span>
            <span class="value">{{ user_email }}</span>
        </div>
    </div>

    <!-- Summary Box -->
    <div class="summary-box">
        <h2>About This Transcript</h2>
        <p>
            This document contains your complete conversation with Nova, your AI ship consultant.
            Nova helped you discover the perfect Star Citizen ships based on your playstyle, budget,
            and preferences. Use this transcript to review the consultation and share with friends or org members.
        </p>
    </div>

    <!-- Conversation Messages -->
    <div class="conversation">
        <h2 style="color: #1e293b; font-size: 18pt; margin-bottom: 20px; border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">
            Conversation History
        </h2>

        {% for message in messages %}
        <div class="message {{ message.role }}">
            <div class="message-header">
                <span class="message-role {{ message.role }}">
                    {% if message.role == 'user' %}You{% else %}Nova{% endif %}
                </span>
                {% if message.timestamp %}
                <span class="message-timestamp">{{ message.timestamp }}</span>
                {% endif %}
            </div>
            <div class="message-content">{{ message.content }}</div>
        </div>
        {% endfor %}
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>
            Generated on {{ generated_at }}<br>
            <strong>StarCiti Sales Agent</strong> - Your AI-Powered Ship Consultant<br>
            Visit <a href="https://robertsspaceindustries.com">robertsspaceindustries.com</a> to explore the verse
        </p>
    </div>
</body>
</html>
